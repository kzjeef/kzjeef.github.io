---
layout: post
title: C++ï¼š Disallow evil constructors.
date: 2013-01-29 16:14:33.000000000 +08:00
type: post
published: true
status: publish
categories:
- C++
tags: []
meta:
  _wpas_done_all: '1'
  _edit_last: '1'
author:
  login: kzjeef
  email: kzjeef@gmail.com
  display_name: kzjeef
  first_name: ''
  last_name: ''
---
<p>I have not write C++ code for years, recently because some reason, also because c++11, have start touch c++.</p>
<p>Today found a very funny macro in google's android c++ code, it maybe very populary in c++ world, but I still want to write some about this.</p>
<p>The macro is like this:</p>
<pre class="lang:c++ decode:true" title="Disallow evil constructors.">// A macro to disallow the copy constructor and operator= functions
// This should be used in the private: declarations for a class
#define DISALLOW_COPY_AND_ASSIGN(TypeName) 
  TypeName(const TypeName&amp;);               
  void operator=(const TypeName&amp;)

// An older, deprecated, politically incorrect name for the above.
// NOTE: The usage of this macro was baned from our code base, but some
// third_party libraries are yet using it.
// TODO(tfarina): Figure out how to fix the usage of this macro in the
// third_party libraries and get rid of it.
#define DISALLOW_EVIL_CONSTRUCTORS(TypeName) DISALLOW_COPY_AND_ASSIGN(TypeName)</pre>
<p>From the comment, you can see this macro declear the copy constructor and assign operator.</p>
<p>If you want to disabllow these two "help" function generated by c++ complier, you can do the macro the private, like this:</p>
<pre class="lang:c++ decode:true ">class Foo {
public:
  int bar();
private:
DISALLOW_EVIL_CONSTRUCTORS(Foo);
};</pre>
<p>This macro will do this for you, generally, you want do this in all you c++ class, except you really need it.</p>
<p>This macro was in many project, like chromium, regex-re2, skia, srec, webrtc, android.</p>
<p>&nbsp;</p>
